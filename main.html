<!DOCTYPE html>
<html>
  <head>
    <style>
      
      /* reset all styles to default */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      /* Nav Bar Styles*/
      
      /* set Nav bar colour to blue and add some padding */
      .navbar {
        background-color: #023e8A;
        padding: 1rem 2rem;
        
      }
      
      /* Make sure content won't stretch to wide and aligns all items to the center */ 
      .navContainer {
        max-width: 1200px;
        margin: 0 auto;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      /* Switch menu styles */

      /* Creates the pill shaped container on transparent background */
      .switchMenu {
        position: relative;
        display: flex;
        background-color: rgba(255,255,255,0.2);
        border-radius: 40px;
        padding: 5px;
        width: 240px;
        cursor: pointer;
      
      }

      /* Styling of each option */
      

      .switchOption {
        flex: 1;
        text-align: center;
        padding: 10px 20px;
        color: white;
        font-size: 15px;
        font-weight: 500;
        transition: color 0.3s ease;
        z-index: 1;
        position: relative;
        cursor: pointer;
      }

      /* Create the moving white slider */

      .switchSlider {
        position: absolute;
        top: 5px;
        left: 5px;
        width: calc(50% - 5px);
        height: calc(100% - 10px);
        background-color: white;
        border-radius: 30px;
        transition: transform 0.3s ease;
        pointer-events: none;
      }
      /* Code to move the slider when option 2 is clicked */

      .switchMenu.option2 .switchSlider {
        transform: translateX(calc(100% + 0px));
        
      }
      /* Topic Header CSS */
        /* Create Header Container white and Correct size */
      .topicsHeader {
        background-color: white;
        padding: 1rem 2rem;
        margin: 1rem auto;
        max-width: 1200px;
        border-radius: 8px;
      }

      /* Text for topic header Styles */

      .topicsHeader h2 {
        color: #1e293b;
        font-size: 1.5rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
        
      }

      /* Underline */

      .headerUnderline {
        height: 5px;
        width: 100%;
        background-color: #2563eb;
        border-radius: 2px;
      }

      /* Topics Container */
      .topicsContainer {
        max-width: 1200px
        margin: 2rem auto;
        padding: 0 1rem;
      }
      /* Container for the list of topics */
      .topicsList {
        display: flex;
        flex-direction: column;
        padding: 1rem;
        gap: 0.75rem;
      }
    /* Create The rows for each topic */
      .topicsRow {
        display: flex;
        align-items: center;
        display: flex;
        align-items: center;
        justify-content: space-between;
        width: 100%;
        padding: 1rem 1.5rem;
        background-color: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.2s ease;
        text-align: left;
      }
        
      

      
      
    </style>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  </head>
  <body>

    <nav class='navbar'>
      <div class='navContainer'>
        <div class='switchMenu'>
          <div class='switchOption active' data-option='option1'>Study Now</div>
          <div class='switchOption' data-option='option2'>View Analytics</div>
          <div class='switchSlider'></div>
        
        
        </div>
        
      </div>
    </nav>


    
    <!-- Topic Header Container -->
    <div class='topicsHeader'>
      <h2>
        Topics
      </h2>
      <div class='headerUnderline'>
        
      </div>
    </div>
    <!-- Topics Container -->
    <div class='topicsContainer'>
      <div class='topicsList' id='topicsList'>
      
      </div>
    </div>


    <script>
          //The supabase url
    const supabase_url = 'https://pxjndwrkafegopsolnde.supabase.co'
    //Supabase key
    const supabase_key = 'sb_publishable_eOUJ3K3GNczOncszRwYhyA_A1QAw72F'
    //Initialize supabase client
    const supabaseClient = supabase.createClient(
      'https://pxjndwrkafegopsolnde.supabase.co',
      'sb_publishable_eOUJ3K3GNczOncszRwYhyA_A1QAw72F'
    );
      //Set the username as the one in session storage
      const username = sessionStorage.getItem('currentUser');
      //Change div content to the username in session storage
      if (username) {
        document.getElementById('displayUsername').textContent = username;
      }
      // Fetch topics from the database
      async function fetchTopics() {
        const topicsGrid = document.getElementById('topicsList');

        const {data: topics,error} = await supabaseClient
          .from('topics')
          .select('topic_name')
        displayTopics(topics);
        
      }

      //Function to display topics
      function displayTopics(topics){
        const topicsGrid = document.getElementById('topicsList');
        // ✅ Correct:
        topics.forEach(topic => {
          const row = createTopicRow(topic);
          topicsGrid.appendChild(row);
        });

  // Function to create the Row
  function createTopicRow(topic) {
    // Create the Button
    const row = document.createElement('button');
    row.className = 'topicsRow';
    row.setAttribute('data-topic-id', topic.topic_id);
    
    // Add click handler to the button
    row.addEventListener('click', function() {
      console.log('Topic clicked:', topic.topic_name);
      // Add your topic click logic here
      // For example: window.location.href = `/topic/${topic.topic_id}`;
      alert(`Topic "${topic.topic_name}" clicked!`);
    });
    
    // Build the HTML inside the row
    row.innerHTML = `
      <div style="flex: 1; text-align: left;">
        <div class="topicName">${topic.topic_name || 'Unnamed Topic'}</div>
      </div>
      <div style="color: #64748b; font-size: 0.9rem;">▶</div>
    `;
    
    return row;
  }




        


      
      document.addEventListener('DOMContentLoaded', function() {
        fetchTopics();
        
        // Find and store references to important elements
        const switchMenu = document.querySelector('.switchMenu');
        const switchOptions = document.querySelectorAll('.switchOption'); // Fixed: was 'switchOptions'

        // Store the content sections in an object
        const contents = {
          option1: document.getElementById('content-option1'),
          option2: document.getElementById('content-option2') // Fixed: added comma
        };
        
        // Add a click listener to each option
        switchOptions.forEach(option => {
          option.addEventListener('click', function() {
            const selectedOption = this.dataset.option;
            
            //Remove 'active' class from all options
            switchOptions.forEach(opt => opt.classList.remove('active')); // Fixed: added 'opt =>'

            //Add active class to the selected option
            this.classList.add('active');

            //Make the clicked option look selected
            if (selectedOption === 'option2') { // Fixed: added parentheses around condition
              switchMenu.classList.add('option2');
            }
            else {
              switchMenu.classList.remove('option2');
            }

            //Show or hide the correct content
            if (selectedOption === 'option1') {
              contents.option1.classList.add('active');
              contents.option2.classList.remove('active'); // Fixed: added closing parenthesis
            }
            else {
              contents.option2.classList.add('active');
              contents.option1.classList.remove('active');
            }
          });
        });
      });
    </script>
  </body>
</html>
